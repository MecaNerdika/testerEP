<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kuis Satuan Sederhana</title>
  <style>
    :root{
      --bg:#060000;       /* slate-900 */
      --card:#111827;     /* gray-900 */
      --muted:#334155;    /* slate-600 */
      --text:#ffffff;     /* gray-200 */
      --accent:#38bdf8;   /* sky-400 */
      --accent-2:#22c55e; /* green-500 */
      --danger:#ef4444;   /* red-500 */
      --warn:#f59e0b;     /* amber-500 */
      --shadow: 0 8px 24px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 800px at 10% -10%, #1e293b, transparent),
                  radial-gradient(800px 600px at 120% 0%, #0b3b47, transparent),
                  var(--bg);
      color:var(--text);
      min-height:100svh; display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .app{width:100%; max-width:980px}
    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px;
    }
    .brand{font-weight:800; letter-spacing:.5px; font-size:clamp(18px,3.5vw,24px)}
    .timer{font-variant-numeric:tabular-nums; font-weight:700; padding:10px 14px; border-radius:999px; background:#0b1220; border:1px solid #1f2a44; box-shadow:var(--shadow)}
    .card{background:linear-gradient(180deg,#0b1220,#0a1020); border:1px solid #1f2a44; border-radius:var(--radius); box-shadow:var(--shadow)}
    .section{display:none}
    .active{display:block}
    .card-inner{padding:20px}
    .grid{display:grid; gap:16px}
    .grid-2{grid-template-columns: 1fr 1fr}
    .grid-responsive{grid-template-columns: 1fr;}
    @media (min-width:720px){ .grid-responsive{grid-template-columns: 1fr 320px} }

    input[type="text"], input[type="password"]{
      width:100%; padding:12px 14px; border-radius:12px; border:1px solid #26314d; background:#0b1220; color:var(--text);
      outline:none; box-shadow:inset 0 0 0 9999px rgba(255,255,255,0);
    }
    label{font-size:14px; color:#cbd5e1}
    .btn{cursor:pointer; padding:12px 16px; border-radius:14px; background:var(--accent); color:#001219; border:none; font-weight:700; box-shadow:var(--shadow); transition:.2s transform ease;}
    .btn:active{transform:translateY(1px)}
    .btn.secondary{background:#1f2937; color:#e2e8f0; border:1px solid #334155}
    .btn.warn{background:var(--warn); color:#0b1220}
    .btn.danger{background:var(--danger); color:#0b1220}
    .muted{color:#94a3b8}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:#0b1220; border:1px solid #223156; font-size:12px; color:#cbd5e1}

    .question-area{display:flex; flex-direction:column; gap:14px}
    .q-title{font-weight:800; font-size:18px}
    .choices{display:grid; gap:10px}
    .choice{display:flex; gap:10px; align-items:flex-start; border:1px solid #1f2a44; background:#0b1220; padding:12px; border-radius:12px; cursor:pointer}
    .choice input{margin-top:4px}

    .nav{display:flex; gap:10px; flex-wrap:wrap; max-height:240px; overflow:auto; padding:10px}
    .nav button{width:44px; height:40px; border-radius:10px; border:1px solid #1f2a44; background:#0b1220; color:#cbd5e1; font-weight:700; cursor:pointer}
    .nav button.active{outline:2px solid var(--accent); color:#0ea5e9}
    .nav button.done{background:#07291f; border-color:#0b7a53; color:#34d399}

    .footer-actions{display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:10px}

    .legend{display:flex; gap:8px; flex-wrap:wrap}

    .results{display:grid; gap:12px}
    .score-box{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .score-card{background:#0b1220; border:1px solid #1f2a44; border-radius:14px; padding:14px}

    .info-row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">Kuis satuan sederhana</div>
      <div class="pill" id="infoUser">Belum login</div>
      <div class="timer" id="timer">21:00</div>
    </header>

    <!-- SECTION 1: FORM MINIMAL -->
    <section id="section-form" class="section active">
      <div class="card">
        <div class="card-inner grid">
          <div>
            <h2 style="margin:0 0 10px 0">Masuk Kuis</h2>
            <p class="muted" style="margin-top:0">Masukkan nama dan password untuk memulai. Tidak ada pengaturan tambahan.</p>
            <div class="grid">
              <div>
                <label for="nama">Nama</label>
                <input id="nama" type="text" placeholder="Nama peserta" />
              </div>
              <div>
                <label for="pass">Password</label>
                <input id="pass" type="password" placeholder="Password" />
              </div>
              <button class="btn" id="btnMulai">Mulai Kuis</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 2: QUIZ -->
    <section id="section-quiz" class="section">
      <div class="grid grid-responsive">
        <div class="card">
          <div class="card-inner">
            <div class="info-row">
              <div class="pill" id="infoKategori">Kategori: -</div>
              <div class="pill" id="infoSoal">Soal 0 / 180</div>
            </div>
            <div class="question-area" id="questionArea">
              <!-- Question inject here -->
            </div>
            <div class="footer-actions">
              <button class="btn secondary" id="prevBtn">Prev</button>
              <div class="legend">
                <span class="pill">• Biru = aktif</span>
                <span class="pill" style="background:#07291f; color:#34d399; border-color:#0b7a53">• Hijau = terjawab</span>
              </div>
              <button class="btn" id="nextBtn">Next</button>
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-inner">
            <h3 style="margin-top:0">Navigasi Soal</h3>
            <div class="nav" id="nav">
              <!-- Nav buttons injected here -->
            </div>
            <div class="grid" style="margin-top:8px">
              <button class="btn warn" id="btnSubmit">Kumpulkan Jawaban</button>
              <button class="btn danger" id="btnReset">Reset Jawaban</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- SECTION 3: HASIL -->
    <section id="section-result" class="section">
      <div class="card">
        <div class="card-inner results">
          <h2 style="margin:0">Hasil Ujian</h2>
          <p class="muted" id="resultUser">Peserta: -</p>
          <div class="score-box">
            <div class="score-card" style="grid-column: span 2">
              <div class="muted">Total Skor</div>
              <div id="scoreTotal" style="font-size:30px; font-weight:900">0 / 180</div>
            </div>
          </div>
          <div>
            <button class="btn" id="btnUlang">Mulai Lagi</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    /** UTIL **/
    const el = (sel) => document.querySelector(sel);
    const els = (sel) => Array.from(document.querySelectorAll(sel));
    const shuffle = (arr) => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);

    /** BANK SOAL (40/40/40) **/
    // Format: {type:'sinonim'|'antonim'|'hiponim', q:'', options:['','','',''], answer: index}

    const SOAL_SATUAN = [

        {  q: "3 lusin + 2 kodi = ... buah",  o: ["74","76","78","80"],  a: 1 },
        {  q: "2 gross – 5 lusin = ... buah",  o: ["220","224","228","232"],  a: 2 },
        {  q: "1 gross + 1 kodi = ... lusin",  o: ["12","13","14","15"],  a: 1 },
        {  q: "Rudi membeli 1 gross kelereng. Ia memberikan 2 lusin kelereng kepada adiknya. Berapa kelereng yang masih dimiliki Rudi?",  o: ["120","124","128","132"],  a: 0 },

        {  q: "2 km + 450 m = ... meter",  o: ["2400","2450","2500","2550"],  a: 1 },
        {  q: "4 hm – 25 dam = ... meter",  o: ["100","150","200","250"],  a: 1 },
        {  q: "5600 m = ... km",  o: ["5.4","5.5","5.6","5.7"],  a: 2 },
        {  q: "Jarak rumah Dita ke sekolah 1.2 km. Dari sekolah ke toko buku 800 m, lalu ke rumah nenek 1 km. Berapa meter total jarak perjalanan Dita?",  o: ["2900","3000","3100","3200"],  a: 1 },

        {  q: "4 jam + 75 menit = ... menit",  o: ["310","315","320","325"],  a: 1 },
        {  q: "2 hari – 9 jam = ... jam",  o: ["36","37","38","39"],  a: 3 },
        {  q: "720 menit = ... jam",  o: ["10","11","12","13"],  a: 2 },
        {  q: "Toni belajar dari pukul 08.15 sampai 11.00, lalu istirahat 45 menit, kemudian lanjut belajar lagi 1 jam 30 menit. Berapa lama total Toni belajar?",  o: ["3.75","4","4.25","4.5"],  a: 2 },

        {  q: "1 kg + 850 g = ... gram",  o: ["1800","1850","1900","1950"],  a: 1 },
        {  q: "3 kg – 750 g = ... gram",  o: ["2200","2250","2300","2350"],  a: 1 },
        {  q: "2 kg + 400 g = ... ons",  o: ["20","22","24","26"],  a: 2 },
        {  q: "Ibu membeli 1.2 kg beras, 5 ons gula, dan 350 g kacang. Berapa gram total belanjaan ibu?",  o: ["2000","2050","2100","2150"],  a: 1 },

        {  q: "4 liter + 600 ml = ... ml",  o: ["4500","4600","4700","4800"],  a: 1 },
        {  q: "3 liter – 850 ml = ... liter",  o: ["2.05","2.1","2.15","2.2"],  a: 2 },
        {  q: "1 liter + 250 ml = ... cc",  o: ["1100","1150","1200","1250"],  a: 3 },
        {  q: "Sebuah teko berisi 2 liter jus. Kemudian ditambahkan 3 botol kecil, masing-masing 350 ml. Berapa liter total isi teko?",  o: ["2.95","3.0","3.05","3.1"],  a: 2 },

        {  q: "36 bulan = ... tahun",  o: ["2","3","4","5"],  a: 1 },
        {  q: "5 windu – 20 tahun = ... tahun",  o: ["12","16","20","24"],  a: 2 },
        {  q: "3 milenium = ... abad",  o: ["20","25","30","35"],  a: 2 },
        {  q: "Usia seorang nenek 72 tahun. Berapa usianya dalam satuan windu?",  o: ["8","9","10","11"],  a: 1 },

        {  q: "Seorang penjual memiliki 3 gross apel. Ia menjual 2 kodi apel, lalu 4 lusin apel busuk. Sisanya dikemas dalam dus berisi 50 apel. Berapa dus penuh yang dapat dibuat penjual?",  o: ["5","6","7","8"],  a: 1 },
        {  q: "Jarak kota A ke kota B adalah 3.5 km. Jarak dari kota B ke kota C adalah 1200 m. Seseorang berjalan dari kota A ke B, lalu ke C. Jika ia sudah menempuh 2.7 km pertama dengan sepeda, berapa meter sisa perjalanan yang harus ditempuh?",  o: ["1900","2000","2100","2200"],  a: 1 },
        {  q: "Dani berlatih olahraga 1.5 jam setiap hari, kecuali hari Minggu ia berlatih 2 jam. Dalam 3 minggu, Dani sempat libur 2 hari. Berapa total jam Dani berlatih?",  o: ["29.5","30","30.5","31"],  a: 1 },
        {  q: "Sebuah toko memiliki 12.5 kg beras. Beras tersebut dikemas dalam kantong kecil masing-masing 750 g. Setelah 4 kantong terjual, berapa kantong penuh yang masih tersisa?",  o: ["12","13","14","15"],  a: 0 },
        {  q: "Sebuah tangki air berisi 24 liter. Kemudian ditambah 5 ember, masing-masing 3 liter. Setelah itu, 1/3 bagian air dipakai untuk menyiram tanaman. Berapa liter air yang tersisa dalam tangki?",  o: ["24","25","26","27"],  a: 2 }

    ].map(x=>({type:'SOAL SATUAN', q:x.q, options:x.o, answer:x.a}));

    
    
    S_SATUAN = shuffle(SOAL_SATUAN)

    /*  Validasi jumlah
    if(SINONIM.length!==90||ANTONIM.length!==90){
      console.warn('Jumlah soal tidak 90/90:', SINONIM.length, ANTONIM.length);
    }  */

    // /* Gabung & acak
    function shuffleOptions(q){  
        let opts = q.options.map((opt, i) => ({opt, i}));
        opts = shuffle(opts); // pake fungsi shuffle yang sudah kamu punya
        let newAnswer = opts.findIndex(o => o.i === q.answer);
        return {
            ...q,
            options: opts.map(o => o.opt),
            answer: newAnswer
  };
  
}
//*/
    let QUESTIONS = [...S_SATUAN].map((q,i)=>({id:i+1, ...shuffleOptions(q)}));
    // let QUESTIONS = [...SINONIM, ...ANTONIM].map((q,i)=>({id:i+1, ...q }));
    // State
    let state = {
      user:null,
      timeLeft: 20*60, // 45 menit
      currentIndex: 0,
      answers: Array(180).fill(null), // simpan index jawaban (0..3) atau null
    };

    /** RENDERING **/
    function formatTime(s){
      const m = Math.floor(s/60).toString().padStart(2,'0');
      const r = (s%60).toString().padStart(2,'0');
      return `${m}:${r}`;
    }

    function renderTimer(){
      el('#timer').textContent = formatTime(state.timeLeft);
      if(state.timeLeft <= 60){ el('#timer').style.background = '#331a1a'; el('#timer').style.borderColor = '#7f1d1d'; }
      if(state.timeLeft <= 0){
        submitQuiz();
      }
    }

    let tick = null;
    function startTimer(){
      if(tick) clearInterval(tick);
      tick = setInterval(()=>{ state.timeLeft--; renderTimer(); if(state.timeLeft<=0) clearInterval(tick); }, 1000);
    }

    function mountNav(){
      const nav = el('#nav');
      nav.innerHTML = '';
      QUESTIONS.forEach((q,idx)=>{
        const b = document.createElement('button');
        b.textContent = idx+1;
        b.addEventListener('click', ()=>{ goTo(idx); });
        nav.appendChild(b);
      });
      updateNavActive();
    }

    function updateNavActive(){
      const buttons = els('#nav button');
      buttons.forEach((b,idx)=>{
        b.classList.toggle('active', idx===state.currentIndex);
        b.classList.toggle('done', state.answers[idx]!==null);
      });
      el('#infoSoal').textContent = `Soal ${state.currentIndex+1} / ${QUESTIONS.length}`;
      el('#infoKategori').textContent = `Kategori: ${QUESTIONS[state.currentIndex].type.toUpperCase()}`;
    }

    function renderQuestion(){
      const q = QUESTIONS[state.currentIndex];
      const container = el('#questionArea');
      container.innerHTML = '';
      const title = document.createElement('div');
      title.className = 'q-title';
      title.textContent = q.q;
      container.appendChild(title);

      const list = document.createElement('div');
      list.className = 'choices';
      q.options.forEach((opt, i)=>{
        const row = document.createElement('label');
        row.className = 'choice';
        const input = document.createElement('input');
        input.type = 'radio'; input.name = 'choice'; input.value = i;
        input.checked = state.answers[state.currentIndex]===i;
        input.addEventListener('change', ()=>{
          state.answers[state.currentIndex]=i;
          updateNavActive();
        });
        const span = document.createElement('div');
        span.textContent = opt;
        row.appendChild(input); row.appendChild(span); list.appendChild(row);
      });
      container.appendChild(list);
    }

    function goTo(idx){
      state.currentIndex = Math.max(0, Math.min(QUESTIONS.length-1, idx));
      updateNavActive();
      renderQuestion();
    }

    function next(){ if(state.currentIndex < QUESTIONS.length-1){ goTo(state.currentIndex+1); } }
    function prev(){ if(state.currentIndex > 0){ goTo(state.currentIndex-1); } }

    function resetAnswers(){
      if(!confirm('Yakin reset semua jawaban?')) return;
      state.answers = Array(QUESTIONS.length).fill(null);
      updateNavActive();
      renderQuestion();
    }

    function submitQuiz(){
      // hitung skor per kategori
      let sSin=0, sAnt=0, sHip=0;
      QUESTIONS.forEach((q,idx)=>{
        const pick = state.answers[idx];
        const correct = q.answer;
        if(pick===correct){
          if(q.type==='SOAL SATUAN') sSin++;
        }
      });
      const total = sSin + sAnt + sHip;

      // tampilkan

      el('#scoreTotal').textContent = `${total} / 29`;
      el('#resultUser').textContent = `Peserta: ${state.user?.nama || '-'} (waktu habis/kumpul)`;

      // stop timer, ganti section
      if(tick) clearInterval(tick);
      showSection('result');
      window.scrollTo({top:0, behavior:'smooth'});
    }

    function showSection(which){
      el('#section-form').classList.remove('active');
      el('#section-quiz').classList.remove('active');
      el('#section-result').classList.remove('active');
      if(which==='form') el('#section-form').classList.add('active');
      if(which==='quiz') el('#section-quiz').classList.add('active');
      if(which==='result') el('#section-result').classList.add('active');
    }

    // EVENTS
    el('#btnMulai').addEventListener('click', ()=>{
      const nama = el('#nama').value.trim();
      const pass = el('#pass').value.trim();
      if(!nama || !pass){ alert('Nama dan password wajib diisi.'); return; }
      if(pass!=="KEDINASANEP"){
        alert("password salah! tanya password ke sir hardi. klo sir hardi dak tau tanya ke sir meca");
        return;
      }
      state.user = {nama, pass};
      el('#infoUser').textContent = `Peserta: ${nama}`;
      showSection('quiz');
      startTimer();
      mountNav();
      goTo(0);
      renderTimer();
    });

    el('#prevBtn').addEventListener('click', prev);
    el('#nextBtn').addEventListener('click', next);
    el('#btnReset').addEventListener('click', resetAnswers);
    el('#btnSubmit').addEventListener('click', ()=>{
      if(confirm('Kumpulkan jawaban sekarang?')) submitQuiz();
    });

    // Keyboard nav: panah kiri/kanan, angka 1-4 untuk memilih A-D
    window.addEventListener('keydown', (e)=>{
      if(!el('#section-quiz').classList.contains('active')) return;
      if(e.key==='ArrowRight') next();
      if(e.key==='ArrowLeft') prev();
      if(['1','2','3','4'].includes(e.key)){
        const idx = parseInt(e.key)-1;
        state.answers[state.currentIndex]=idx;
        updateNavActive();
        renderQuestion();
      }
    });

    // Ulang dari hasil
    el('#btnUlang').addEventListener('click', ()=>{
      state = { user: state.user, timeLeft: 245*60, currentIndex: 0, answers: Array(180).fill(null)};
      QUESTIONS = shuffle(QUESTIONS); // acak ulang urutan
      showSection('quiz');
      startTimer();
      mountNav();
      goTo(0);
      renderTimer();
    });

  </script>
</body>
</html>
