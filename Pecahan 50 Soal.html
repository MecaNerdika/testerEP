<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Operasi Pecahan - TIU CPNS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom animation for pulse effect on timer */
        @keyframes pulse-red {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .pulse-red {
            animation: pulse-red 1s infinite;
        }
        /* Hide scrollbar for indicator but keep functionality */
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen font-sans">

    <!-- Container Utama -->
    <main class="container mx-auto p-4 max-w-4xl">

        <!-- Layar Token (Awal) -->
        <section id="tokenScreen" class="flex flex-col items-center justify-center min-h-screen">
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
                <h1 class="text-3xl font-bold text-center text-indigo-700 mb-2">Kuis TIU</h1>
                <p class="text-center text-gray-600 mb-6">Operasi Campuran Pecahan</p>
                <form id="tokenForm" class="space-y-4">
                    <div>
                        <label for="tokenInput" class="block text-sm font-medium text-gray-700">Masukkan Token Ujian</label>
                        <input type="password" id="tokenInput" required placeholder="Token diberikan oleh tutor" 
                               class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    </div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300 font-semibold">
                        Mulai Kuis
                    </button>
                    <p id="tokenError" class="text-red-500 text-sm text-center hidden">Token salah! Silakan coba lagi.</p>
                </form>
            </div>
        </section>

        <!-- Layar Kuis -->
        <section id="quizScreen" class="hidden">
            <!-- Header Kuis -->
            <header class="bg-white rounded-lg shadow-md p-4 mb-4 flex justify-between items-center">
                <div>
                    <h2 class="text-xl font-bold text-gray-800">Kuis Operasi Pecahan</h2>
                    <p class="text-sm text-gray-600">Soal <span id="currentQuestionNumber">1</span> dari 50</p>
                </div>
                <div id="timerContainer" class="text-right">
                    <p class="text-sm text-gray-600">Sisa Waktu</p>
                    <p id="timer" class="text-2xl font-bold text-gray-800">30:00</p>
                </div>
            </header>

            <!-- Indikator Soal -->
            <div class="bg-white rounded-lg shadow-md p-2 mb-4">
                <div id="questionIndicator" class="flex gap-1 overflow-x-auto hide-scrollbar">
                    <!-- Indikator akan dibuat oleh JavaScript -->
                </div>
            </div>

            <!-- Area Soal -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-4">
                <h3 id="questionText" class="text-lg font-semibold text-gray-800 mb-4">
                    <!-- Soal akan dimuat di sini -->
                </h3>
                <div id="optionsContainer" class="space-y-3">
                    <!-- Opsi akan dimuat di sini -->
                </div>
            </div>

            <!-- Navigasi -->
            <footer class="flex justify-between">
                <button id="prevBtn" class="bg-gray-400 text-white py-2 px-6 rounded-md hover:bg-gray-500 transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Sebelumnya
                </button>
                <button id="nextBtn" class="bg-indigo-600 text-white py-2 px-6 rounded-md hover:bg-indigo-700 transition duration-300">
                    Selanjutnya
                </button>
            </footer>
        </section>

        <!-- Layar Hasil -->
        <section id="resultScreen" class="hidden flex flex-col items-center justify-center min-h-screen">
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md text-center">
                <h1 class="text-3xl font-bold text-center text-indigo-700 mb-4">Kuis Selesai!</h1>
                <svg class="w-24 h-24 mx-auto text-green-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <p class="text-5xl font-bold text-gray-800 mb-2"><span id="finalScore">0</span></p>
                <p class="text-lg text-gray-600">dari 50 soal</p>
                <p class="text-md text-gray-500 mt-4">Terima kasih telah mengikuti kuis.</p>
                <button onclick="location.reload()" class="mt-6 w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition duration-300 font-semibold">
                    Kembali ke Awal
                </button>
            </div>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DATA SOAL ---
            const questions = [
                { q: "1/2 + 2/3 - 1/4 = ...", options: ["7/20", "1", "11/12", "1 5/12", "4/9"], answer: 2 },
                { q: "3/4 × 2/5 + 1/2 = ...", options: ["1 7/20", "7/10", "3/5", "9/10", "1/2"], answer: 0 },
                { q: "5 1/2 - 2 1/3 + 1/4 = ...", options: ["3 5/12", "3 1/6", "3 1/4", "3 7/12", "3 11/12"], answer: 0 },
                { q: "7/8 : 1/2 - 1/4 = ...", options: ["3/4", "1/2", "1 1/4", "1/8", "1"], answer: 0 },
                { q: "2/3 + 1 1/4 × 1/5 = ...", options: ["7/8", "29/30", "31/40", "1 1/10", "13/15"], answer: 3 },
                { q: "4 1/5 - 3/10 + 2/3 = ...", options: ["4 1/6", "4 1/2", "4 7/30", "4 11/30", "4 1/3"], answer: 2 },
                { q: "1/5 + 3/4 × 2/3 = ...", options: ["1/2", "7/10", "3/5", "13/20", "9/20"], answer: 1 },
                { q: "6 2/3 - 1 1/2 : 3/4 = ...", options: ["4 2/3", "4 1/3", "4 5/6", "4 1/6", "4 4/9"], answer: 0 },
                { q: "3/7 + 2/5 - 1/3 = ...", options: ["32/105", "22/35", "1/2", "6/35", "2/5"], answer: 0 },
                { q: "1 1/8 × 2/3 + 1/4 = ...", options: ["1", "1 1/4", "3/4", "1 1/8", "5/8"], answer: 0 },
                { q: "5/6 - 1/3 + 2/5 = ...", options: ["19/30", "7/10", "23/30", "4/5", "9/15"], answer: 0 },
                { q: "2 1/4 : 3/8 - 1/2 = ...", options: ["5", "5 1/2", "4 1/2", "6", "4"], answer: 0 },
                { q: "3/5 + 4/9 - 1/3 = ...", options: ["34/45", "2/3", "7/9", "31/45", "8/15"], answer: 0 },
                { q: "1 2/3 × 3/4 - 1/2 = ...", options: ["3/4", "1/4", "1/2", "1", "5/8"], answer: 0 },
                { q: "7/10 + 1/5 - 2/5 = ...", options: ["1/2", "3/5", "2/5", "1/10", "4/5"], answer: 0 },
                { q: "3 1/2 - 1 1/4 + 2/3 = ...", options: ["2 11/12", "2 5/6", "2 7/12", "2 9/12", "2 1/2"], answer: 0 },
                { q: "8/9 : 4/3 + 1/6 = ...", options: ["1", "1 1/6", "2/3", "1 1/3", "5/6"], answer: 0 },
                { q: "2/7 + 3/5 × 5/6 = ...", options: ["1/2", "13/14", "17/21", "19/35", "3/7"], answer: 0 },
                { q: "4 3/4 - 2 1/2 + 1/5 = ...", options: ["2 9/20", "2 2/5", "2 1/4", "2 7/10", "2 3/10"], answer: 0 },
                { q: "5/8 + 1/2 : 2 = ...", options: ["3/4", "7/8", "1/2", "5/16", "9/16"], answer: 0 },
                { q: "9/10 - 2/5 + 1/4 = ...", options: ["3/4", "7/10", "4/5", "13/20", "1/2"], answer: 0 },
                { q: "2 1/5 × 3/4 - 1/3 = ...", options: ["1 3/20", "1 7/20", "1 1/5", "1 1/2", "1 9/20"], answer: 0 },
                { q: "3/4 + 5/6 - 2/3 = ...", options: ["11/12", "1", "5/6", "7/8", "1 1/12"], answer: 0 },
                { q: "1 1/2 : 3/4 + 2/5 = ...", options: ["2 1/5", "2 2/5", "1 4/5", "2 3/5", "2"], answer: 1 },
                { q: "4/5 + 1/10 - 1/2 = ...", options: ["2/5", "3/5", "1/2", "4/10", "3/10"], answer: 0 },
                { q: "3 1/3 - 1 1/6 + 1/2 = ...", options: ["2 2/3", "2 1/2", "2 5/6", "2 1/3", "2 3/4"], answer: 0 },
                { q: "6/7 × 7/8 + 1/4 = ...", options: ["1", "7/8", "13/14", "3/4", "5/6"], answer: 0 },
                { q: "5/9 + 2/3 - 1/6 = ...", options: ["1 1/18", "1 1/9", "1 1/6", "1 1/3", "7/9"], answer: 0 },
                { q: "2 3/8 - 1 1/4 : 5/2 = ...", options: ["1 7/8", "1 3/4", "1 5/8", "1 1/2", "2"], answer: 0 },
                { q: "1/3 + 1/4 + 1/6 = ...", options: ["3/4", "5/12", "2/3", "11/12", "1/2"], answer: 0 },
                { q: "7/12 - 1/4 + 1/3 = ...", options: ["2/3", "3/4", "5/6", "8/12", "1/2"], answer: 0 },
                { q: "1 1/7 × 2/3 + 1/2 = ...", options: ["1 1/21", "1 2/21", "1 3/21", "1 4/21", "1 5/21"], answer: 0 },
                { q: "8/15 : 2/5 - 1/3 = ...", options: ["2/3", "1/3", "1", "1/2", "5/9"], answer: 0 },
                { q: "3/10 + 2/5 - 1/8 = ...", options: ["19/40", "21/40", "23/40", "1/2", "9/20"], answer: 0 },
                { q: "5 1/3 - 2 1/4 + 3/8 = ...", options: ["3 5/24", "3 7/24", "3 11/24", "3 13/24", "3 17/24"], answer: 0 },
                { q: "2/9 + 4/5 × 1/2 = ...", options: ["14/25", "2/5", "11/15", "28/45", "4/9"], answer: 0 },
                { q: "9/16 + 1/4 - 1/8 = ...", options: ["11/16", "3/4", "5/8", "13/16", "1/2"], answer: 0 },
                { q: "1 3/5 : 4/5 - 1/2 = ...", options: ["1 1/2", "1", "2", "1/2", "2 1/2"], answer: 0 },
                { q: "4/11 + 5/6 - 1/2 = ...", options: ["4/3", "1 1/3", "1 1/6", "1 5/33", "1 7/33"], answer: 0 },
                { q: "2 2/9 × 3/4 - 1/6 = ...", options: ["1 1/3", "1 1/6", "1 1/2", "1 5/6", "1 1/12"], answer: 0 },
                { q: "11/12 - 5/6 + 1/4 = ...", options: ["3/4", "2/3", "5/8", "7/12", "1/2"], answer: 0 },
                { q: "3 1/4 - 2/5 + 1/2 = ...", options: ["3 7/20", "3 9/20", "3 11/20", "3 13/20", "3 3/20"], answer: 0 },
                { q: "6/13 + 1/2 - 1/4 = ...", options: ["31/52", "29/52", "33/52", "35/52", "27/52"], answer: 0 },
                { q: "1 1/3 × 3/5 + 2/5 = ...", options: ["1", "1 1/5", "4/5", "1 2/5", "2/5"], answer: 0 },
                { q: "5/7 - 1/3 + 2/9 = ...", options: ["38/63", "34/63", "40/63", "2/3", "1/2"], answer: 0 },
                { q: "2 5/6 : 1 1/3 + 1/4 = ...", options: ["2 1/2", "2 1/4", "2 3/4", "2", "2 1/8"], answer: 0 },
                { q: "3/8 + 5/12 - 1/6 = ...", options: ["2/3", "5/8", "3/4", "7/12", "1/2"], answer: 0 },
                { q: "4 1/2 - 3/4 × 2/3 = ...", options: ["4", "4 1/2", "3 1/2", "4 1/4", "3 3/4"], answer: 0 },
                { q: "7/9 + 1/3 - 2/5 = ...", options: ["32/45", "34/45", "28/45", "2/3", "7/10"], answer: 0 },
                { q: "1 7/8 : 1 1/4 + 1/5 = ...", options: ["1 7/10", "1 3/5", "1 4/5", "1 1/2", "1 9/10"], answer: 0 }
            ];

            // --- ELEMEN DOM ---
            const tokenScreen = document.getElementById('tokenScreen');
            const quizScreen = document.getElementById('quizScreen');
            const resultScreen = document.getElementById('resultScreen');
            const tokenForm = document.getElementById('tokenForm');
            const tokenInput = document.getElementById('tokenInput');
            const tokenError = document.getElementById('tokenError');

            const questionText = document.getElementById('questionText');
            const optionsContainer = document.getElementById('optionsContainer');
            const currentQuestionNumber = document.getElementById('currentQuestionNumber');
            const questionIndicator = document.getElementById('questionIndicator');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const timerElement = document.getElementById('timer');
            const finalScoreElement = document.getElementById('finalScore');

            // --- STATE KUIS ---
            let currentQuestionIndex = 0;
            let score = 0;
            let timeLeft = 30 * 60; // 30 menit dalam detik
            let timerInterval;
            let userAnswers = new Array(questions.length).fill(null);
            let shuffledQuestions = [];

            // --- FUNGSI-FUNGSI ---
            function shuffleArray(array) {
                let currentIndex = array.length, randomIndex;
                while (currentIndex != 0) {
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;
                    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
                }
                return array;
            }

            function startQuiz() {
                shuffledQuestions = shuffleArray([...questions]);
                tokenScreen.classList.add('hidden');
                quizScreen.classList.remove('hidden');
                createIndicators();
                displayQuestion();
                startTimer();
            }

            function createIndicators() {
                questionIndicator.innerHTML = '';
                for (let i = 0; i < shuffledQuestions.length; i++) {
                    const indicator = document.createElement('button');
                    indicator.className = 'w-8 h-8 rounded-full text-xs font-semibold text-gray-600 bg-gray-200 hover:bg-gray-300 transition duration-200 flex-shrink-0';
                    indicator.textContent = i + 1;
                    indicator.onclick = () => goToQuestion(i);
                    questionIndicator.appendChild(indicator);
                }
            }

            function updateIndicators() {
                const indicators = questionIndicator.children;
                for (let i = 0; i < indicators.length; i++) {
                    if (userAnswers[i] !== null) {
                        indicators[i].classList.remove('bg-gray-200', 'text-gray-600');
                        indicators[i].classList.add('bg-indigo-600', 'text-white');
                    } else {
                        indicators[i].classList.remove('bg-indigo-600', 'text-white');
                        indicators[i].classList.add('bg-gray-200', 'text-gray-600');
                    }
                    if (i === currentQuestionIndex) {
                        indicators[i].classList.add('ring-2', 'ring-indigo-500');
                    } else {
                        indicators[i].classList.remove('ring-2', 'ring-indigo-500');
                    }
                }
            }

            function displayQuestion() {
                const question = shuffledQuestions[currentQuestionIndex];
                questionText.textContent = question.q;
                currentQuestionNumber.textContent = currentQuestionIndex + 1;

                optionsContainer.innerHTML = '';
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'flex items-center p-3 border rounded-lg cursor-pointer hover:bg-indigo-50 transition duration-200';
                    if (userAnswers[currentQuestionIndex] === index) {
                        optionDiv.classList.add('bg-indigo-100', 'border-indigo-500');
                    }

                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = 'answer';
                    radio.value = index;
                    radio.id = `option${index}`;
                    radio.checked = userAnswers[currentQuestionIndex] === index;
                    radio.className = 'mr-3';

                    const label = document.createElement('label');
                    label.htmlFor = `option${index}`;
                    label.className = 'flex-grow cursor-pointer';
                    label.textContent = `${String.fromCharCode(65 + index)}. ${option}`;

                    optionDiv.appendChild(radio);
                    optionDiv.appendChild(label);
                    optionDiv.onclick = () => selectOption(index);

                    optionsContainer.appendChild(optionDiv);
                });

                updateIndicators();
                updateNavButtons();
            }

            function selectOption(index) {
                userAnswers[currentQuestionIndex] = index;
                displayQuestion(); // Re-render to update selection style
            }

            function goToQuestion(index) {
                currentQuestionIndex = index;
                displayQuestion();
            }

            function updateNavButtons() {
                prevBtn.disabled = currentQuestionIndex === 0;
                if (currentQuestionIndex === shuffledQuestions.length - 1) {
                    nextBtn.textContent = 'Selesai';
                } else {
                    nextBtn.textContent = 'Selanjutnya';
                }
            }

            function nextQuestion() {
                if (currentQuestionIndex < shuffledQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                } else {
                    endQuiz();
                }
            }

            function prevQuestion() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayQuestion();
                }
            }

            function startTimer() {
                timerInterval = setInterval(() => {
                    timeLeft--;
                    const minutes = Math.floor(timeLeft / 60);
                    const seconds = timeLeft % 60;
                    timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    if (timeLeft <= 300) { // 5 menit terakhir
                        timerElement.classList.add('text-red-600', 'font-bold', 'pulse-red');
                    }

                    if (timeLeft <= 0) {
                        endQuiz();
                    }
                }, 1000);
            }

            function endQuiz() {
                clearInterval(timerInterval);
                quizScreen.classList.add('hidden');
                resultScreen.classList.remove('hidden');

                // Hitung skor
                score = 0;
                for (let i = 0; i < shuffledQuestions.length; i++) {
                    if (userAnswers[i] === shuffledQuestions[i].answer) {
                        score++;
                    }
                }
                finalScoreElement.textContent = score;
            }

            // --- EVENT LISTENERS ---
            tokenForm.addEventListener('submit', (e) => {
                e.preventDefault();
                if (tokenInput.value === 'TIU1') {
                    tokenError.classList.add('hidden');
                    startQuiz();
                } else {
                    tokenError.classList.remove('hidden');
                }
            });

            nextBtn.addEventListener('click', nextQuestion);
            prevBtn.addEventListener('click', prevQuestion);

        });
    </script>
</body>
</html>