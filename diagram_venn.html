<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kuiz Diagram Venn — 20 Soal</title>
  <style>
    :root{--bg:#f4fbff;--card:#ffffff;--accent:#2E8BFF;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,var(--bg),#eaf4ff); color:#0f172a}
    .wrap{max-width:980px;margin:24px auto;padding:20px}
    header{display:flex;gap:16px;align-items:center;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 6px 20px rgba(20,40,80,0.06)}
    .auth{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center}
    input[type=text], input[type=password]{padding:10px;border-radius:8px;border:1px solid #dbe7ff;background:#fbfdff}
    button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}
    button.ghost{background:transparent;color:var(--accent);border:1px solid rgba(46,139,255,0.15)}
    .meta{display:flex;gap:12px;align-items:center}
    .timer{font-weight:700;color:#0b5ed7}
    .grid{display:grid;grid-template-columns:220px 1fr;gap:16px;margin-top:16px}
    .sidebar{position:sticky;top:20px}
    .qnav{display:flex;flex-wrap:wrap;gap:6px}
    .qnav button{width:38px;height:38px;border-radius:8px;background:#f1f5f9;border:1px solid #e6eefc}
    .qnav button.answered{background:linear-gradient(180deg,#dff1ff,#e6fbff)}
    .qcard{padding:16px}
    .question{margin-bottom:14px}
    .choices{display:grid;gap:8px}
    .choice{padding:10px;border-radius:8px;border:1px solid #e6eefc;background:#fbfdff;cursor:pointer}
    .choice.selected{border-color:var(--accent);box-shadow:0 4px 12px rgba(46,139,255,0.12)}
    .controls{display:flex;gap:8px;align-items:center;margin-top:12px}
    .progress{height:10px;background:#e6f1ff;border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,#2E8BFF,#60A5FA);width:0%}
    .footer-actions{display:flex;gap:8px;justify-content:flex-end}
    .small{font-size:13px;color:var(--muted)}
    .review-correct{background:#ecffef;border:1px solid #d6f7d6}
    .review-wrong{background:#fff2f2;border:1px solid #ffd6d6}
    @media(max-width:820px){.grid{grid-template-columns:1fr;}.sidebar{position:relative}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="flex:1">
        <h1>Kuiz Diagram Venn — 20 Soal (Pilihan Ganda)</h1>
        <div class="small">Soal-soal berkaitan dengan himpunan dan diagram Venn. </div>
      </div>
      <div class="meta">
        <div class="small">Waktu tersisa:</div>
        <div class="timer" id="timer">00:00</div>
      </div>
    </header>

    <div class="card auth" id="authCard">
      <div style="display:flex;gap:8px;align-items:center">
        <input id="nameInput" type="text" placeholder="Masukkan nama" />
        <input id="pwdInput" type="password" placeholder="Masukkan kata sandi kuiz" />
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="startBtn">Mulai Kuiz</button>
        <button class="ghost" id="helpBtn">Petunjuk</button>
      </div>
      <div class="small" style="grid-column:1/-1;margin-top:8px;color:#334155">Catatan: Kerjakan kuiz dengan jujur.</div>
    </div>

    <div id="app" style="display:none">
      <div class="grid">
        <aside class="sidebar">
          <div class="card" style="margin-bottom:12px">
            <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
              <div>
                <div class="small">Peserta</div>
                <div id="userName" style="font-weight:700">-</div>
              </div>
              <div style="text-align:right">
                <div class="small">Kemajuan</div>
                <div id="answeredCount">0 / 20</div>
              </div>
            </div>
            <div style="margin-top:12px">
              <div class="small">Kemajuan</div>
              <div class="progress" aria-hidden="true" style="margin-top:6px"><i id="progBar"></i></div>
            </div>
          </div>

          <div class="card">
            <div class="small" style="margin-bottom:8px">Navigasi Soal</div>
            <div class="qnav" id="qnav"></div>
            <div style="margin-top:10px" class="small">Gunakan tombol nomor untuk lompat cepat. Soal berwarna biru muda = sudah dijawab.</div>
          </div>

          <div class="card" style="margin-top:12px">
            <div class="small">Kontrol Cepat</div>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="prevBtn">Sebelumnya</button>
              <button id="nextBtn">Berikutnya</button>
            </div>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button id="saveBtn" class="ghost">Simpan lokal</button>
              <button id="submitBtn">Kirim & Lihat Hasil</button>
            </div>
          </div>
        </aside>

        <main>
          <div class="card qcard" id="questionCard">
            <div class="question" id="questionText">Memuat soal...</div>
            <div class="choices" id="choices"></div>
            <div class="controls">
              <div class="small">Waktu kuis: <span id="totalTimeLabel">20:00</span></div>
              <div style="flex:1"></div>
              <div class="small">Navigasi: ← →</div>
            </div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;justify-content:space-between;align-items:center">
            <div class="small">Tekan angka 1-5 untuk memilih jawaban cepat.</div>
            <div class="footer-actions">
              <button id="flagBtn" class="ghost">Tandai</button>
              <button id="clearBtn" class="ghost">Bersihkan</button>
              <button id="prevBtnBottom">Sebelumnya</button>
              <button id="nextBtnBottom">Berikutnya</button>
            </div>
          </div>

          <div id="afterSubmit" style="display:none;margin-top:12px"></div>
        </main>
      </div>
    </div>

  </div>

  <script>
  // --- Konfigurasi ---
  const CONFIG = {
    password: 'venn123', // default kata sandi
    durationMinutes: 20 // durasi kuiz default
  };

  // --- Soal (20 soal) ---
  const questions = [
    { id:1, text: `Hasil survei terhadahap beberapa anak menunjukan bahwa 26 menyukai kartun A, 18 menyukai kartun B, dan 10 menyukai kedua kartun. Jika 2 anak tidak menyukai keduanya, berapa jumlah peserta survei?`, choices:["30","32","34","36"], answer:3 },
    { id:2, text:`Dari 48 mahasiswa, 29 suka matematika, 22 suka fisika, dan 8 suka keduanya. Berapa banyak mahasiswa yang tidak suka matematika maupun fisika?`, choices:["1 orang","5 orang","9 orang","18 orang"], answer:1 },
    { id:3, text:`Dalam 100 keluarga, 40 punya sepeda motor, 35 punya mobil, dan 30 tidak punya keduanya. Berapa banyak keluarga yang punya kedua kendaraan?`, choices:["5","15","20","30"], answer:0 },
    { id:4, text:`Dari 50 peserta tes, 40 lulus Matematika, 15 lulus Fisika, 10 lulus keduanya. Berapa peserta yang tidak lulus kedua mata pelajaran?`, choices:["0","5","10","15"], answer:1 },
    { id:5, text:`Dari 40 anak: 18 suka menulis, 20 suka membaca, dan 12 tidak suka menulis maupun membaca. Berapa anak yang suka keduanya?`, choices:["10","12","14","16"], answer:0 },
    { id:6, text:`Persentase siswa ikut PMR 40%, OSIS 30%, dan keduanya 5%. Berapa persen yang tidak ikut keduanya?`, choices:["10%","20%","25%","35%"], answer:3 },
    { id:7, text:`Dari 70 peserta dalam kelas,semuanya gemar berolahraga. 50  dia antaranya gemar sepakbola, 27 gemar voli dan sepakbola. berapa jumlah siswa yang hanya gemar voli?`, choices:["7","8","9","10"], answer:0 },
    { id:8, text:`Dari 35 anak: (19 − x) suka permen, (21 − x) suka coklat, 7 tidak suka keduanya. Jika x adalah yang suka keduanya, berapa anak suka coklat?`, choices:["11","12","13","14"], answer:1 },
    { id:9, text:`38 peserta: 6 sarapan roti & nasi goreng, 5 tidak sarapan. Jika yang sarapan nasi goreng dua kali jumlah yang sarapan roti, banyak yang sarapan nasi goreng saja adalah ...`, choices:["20","25","30","35"], answer:1 },
    { id:10, text:`Dalam survei 60 rumah, 40 memiliki televisi, 20 memiliki radio, dan 10 memiliki keduanya. Berapa rumah yang tidak memiliki televisi maupun radio?`, choices:["0","10","20","30"], answer:1 },
    { id:11, text:`Di kelas 36 siswa: 20 suka musik, 15 suka olahraga, 7 suka keduanya. Berapa siswa yang tidak suka musik dan olahraga?`, choices:["-6 (mustahil)","-2 (mustahil)","4","10"], answer:2 },
    { id:12, text:`Survei 200 orang: 120 suka kopi, 80 suka teh, dan 50 suka keduanya. Berapa yang suka kopi saja?`, choices:["40","50","70","120"], answer:2 },
    { id:13, text:`Dari 90 murid, 60 suka IPA, 45 suka IPS, dan 20 suka keduanya. Berapa murid yang suka setidaknya salah satu?`, choices:["85","70","55","65"], answer:1 },
    { id:14, text:`Di sebuah klub 48 anggota: 30 suka catur, 18 suka kartu, 8 suka keduanya. Berapa yang hanya suka catur?`, choices:["22","30","8","28"], answer:0 },
    { id:15, text:`Dari 120 responden: 90 pakai smartphone, 30 pakai feature phone, dan tidak ada overlap. Berapa yang tidak pakai ponsel?`, choices:["0","10","5","15"], answer:0 },
    { id:16, text:`Dalam 50 siswa, 28 ikut ekskul musik, 20 ikut ekskul tari, 10 ikut keduanya. Berapa siswa yang tidak ikut keduanya?`, choices:["10","12","22","30"], answer:2 },
    { id:17, text:`Survei: 80 orang, 50 suka buah A, 40 suka buah B, 30 suka keduanya. Berapa yang suka setidaknya salah satu?`, choices:["60","70","80","90"], answer:1 },
    { id:18, text:`Di kelompok 100 orang, 65 menonton film X, 45 menonton film Y, 25 menonton keduanya. Berapa yang tidak menonton X maupun Y?`, choices:["-5 (mustahil)","15","35","55"], answer:1 },
    { id:19, text:`Dari 54 siswa, 34 suka bahasa Inggris, 22 suka bahasa Jepang, 8 suka keduanya. Berapa siswa yang hanya suka Inggris?`, choices:["26","34","12","18"], answer:0 },
    { id:20, text:`Survei 200 orang: 140 memiliki akun A, 90 memiliki akun B, 60 memiliki keduanya. Berapa yang punya minimal satu akun?`, choices:["110","170","200","120"], answer:1 }
  ];

  // --- App state ---
  let state = {
    name: '', password: '', cur:0, answers: Array(questions.length).fill(null), flagged: Array(questions.length).fill(false), startedAt:null, endAt:null, timerId:null
  };

  // --- Helpers ---
  const el = id=>document.getElementById(id);
  function formatMMSS(s){const m=Math.floor(s/60), sec=s%60; return String(m).padStart(2,'0')+":"+String(sec).padStart(2,'0')}

  // Render nav and question
  function renderNav(){
    const qnav = el('qnav'); qnav.innerHTML='';
    questions.forEach((q,i)=>{
      const b = document.createElement('button'); b.textContent = i+1; b.title = 'Soal '+(i+1);
      if(state.answers[i]!==null) b.classList.add('answered');
      if(i===state.cur) b.style.outline='3px solid rgba(46,139,255,0.12)';
      b.addEventListener('click',()=>{goTo(i)});
      qnav.appendChild(b);
    });
    el('answeredCount').textContent = answeredCount()+ ' / ' + questions.length;
    const pct = Math.round(answeredCount()/questions.length*100);
    el('progBar').style.width = pct + '%';
  }
  function renderQuestion(){
    const q = questions[state.cur];
    el('questionText').innerHTML = `<strong>Soal ${state.cur+1}.</strong> ${q.text}`;
    const choicesDiv = el('choices'); choicesDiv.innerHTML='';
    q.choices.forEach((c,idx)=>{
      const ch = document.createElement('div'); ch.className='choice'; ch.tabIndex=0; ch.dataset.idx=idx; ch.innerHTML = `${String.fromCharCode(65+idx)}. ${c}`;
      if(state.answers[state.cur]===idx) ch.classList.add('selected');
      ch.addEventListener('click',()=>selectChoice(idx));
      ch.addEventListener('keydown',(ev)=>{ if(ev.key==='Enter'||ev.key===' ') { ev.preventDefault(); selectChoice(idx);} });
      choicesDiv.appendChild(ch);
    });
    el('userName').textContent = state.name || '-';
  }

  function selectChoice(idx){
    state.answers[state.cur] = idx; renderNav(); renderQuestion();
  }
  function goTo(i){ state.cur = i; renderQuestion(); renderNav(); }
  function next(){ if(state.cur<questions.length-1){ state.cur++; renderQuestion(); renderNav(); }}
  function prev(){ if(state.cur>0){ state.cur--; renderQuestion(); renderNav(); }}
  function answeredCount(){ return state.answers.filter(x=>x!==null).length }

  // Timer
  function startTimer(minutes){
    const total = minutes*60; let remain = total;
    el('totalTimeLabel').textContent = minutes+":00";
    el('timer').textContent = formatMMSS(remain);
    if(state.timerId) clearInterval(state.timerId);
    state.timerId = setInterval(()=>{
      remain--; el('timer').textContent = formatMMSS(remain);
      if(remain<=0){ clearInterval(state.timerId); autoSubmit(); }
    },1000);
  }

  // Submit
  function submit(){
    if(!confirm('Yakin ingin mengirim jawaban? Anda tidak bisa mengubah setelah mengirim.')) return;
    finishAndShow();
  }
  function autoSubmit(){ alert('Waktu habis — kuiz diserahkan otomatis.'); finishAndShow(); }

  function finishAndShow(){
    if(state.timerId) clearInterval(state.timerId);
    let correct=0; const review = [];
    for(let i=0;i<questions.length;i++){
      const q=questions[i]; const a = state.answers[i]; const ok = (a===q.answer); if(ok) correct++; review.push({qIndex:i, selected:a, correct:q.answer});
    }
    el('afterSubmit').style.display='block';
    el('afterSubmit').innerHTML = `<div class="card"><h3>Hasil</h3><p>Skor: ${correct} / ${questions.length}</p><p class="small">Anda bisa meninjau tiap soal, melihat jawaban benar dan jawaban Anda.</p><div style="margin-top:12px"><button id="reviewBtn">Tinjau Soal</button>
    <button id="downloadBtn" class="ghost">Unduh Hasil (JSON)</button>
    </div></div>`;
    el('submitBtn').disabled = true;
    document.getElementById('reviewBtn').addEventListener('click',()=>showReview(review));
    document.getElementById('downloadBtn').addEventListener('click',()=>downloadResults(review,correct));
  }

  function showReview(review){
    const main = el('questionCard');
    main.scrollIntoView({behavior:'smooth'});
    const cont = document.createElement('div');
    cont.style.marginTop='12px';
    review.forEach(r=>{
      const q = questions[r.qIndex];
      const wrap = document.createElement('div'); wrap.className = (r.selected===q.answer)?'review-correct card':'review-wrong card';
      wrap.style.marginBottom='8px';
      wrap.innerHTML = `<strong>Soal ${r.qIndex+1}.</strong> ${q.text}<br><div class="small">Jawaban Anda: ${r.selected===null? '—': String.fromCharCode(65+(r.selected)) + '. ' + (r.selected===null? 'Tidak menjawab': q.choices[r.selected])}</div>
      <div class="small">Jawaban benar: ${String.fromCharCode(65+q.answer)}. ${q.choices[q.answer]}</div>`;
      cont.appendChild(wrap);
    });
    el('afterSubmit').appendChild(cont);
  }

  function downloadResults(review,correct){
    const payload = {name:state.name, score:correct, total:questions.length, answers:state.answers, timestamp: new Date().toISOString()};
    const blob = new Blob([JSON.stringify(payload, null, 2)],{type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = `${state.name || 'participant'}-hasil-kuiz.json`; a.click(); URL.revokeObjectURL(url);
  }

  // Save local
  function saveLocal(){
    const dump = {name:state.name, answers:state.answers, flagged: state.flagged, timestamp: new Date().toISOString()};
    localStorage.setItem('venn_quiz_draft', JSON.stringify(dump));
    alert('Jawaban tersimpan di browser (localStorage). Anda bisa memuat ulang halaman tanpa kehilangan data.');
  }
  function loadLocal(){
    const raw = localStorage.getItem('venn_quiz_draft'); if(!raw) return false; try{ const d = JSON.parse(raw); if(d.name) state.name=d.name; if(d.answers) state.answers=d.answers; if(d.flagged) state.flagged=d.flagged; return true;}catch(e){return false}
  }

  // Event handlers
  el('helpBtn').addEventListener('click', ()=>{
    alert('Petunjuk:\n1) Masukkan nama dan kata sandi, lalu klik "Mulai Kuiz".\n2) Gunakan tombol nomor di sebelah kiri untuk lompat soal.\n3) Tekan angka 1-4 untuk memilih jawaban cepat.');
  });

  el('startBtn').addEventListener('click', ()=>{
    const name = el('nameInput').value.trim(); const pwd = el('pwdInput').value;
    if(!name){ alert('Masukkan nama Anda dulu.'); return; }
    if(pwd !== CONFIG.password){ alert('Kata sandi salah.'); return; }
    state.name = name; state.password = pwd; state.startedAt = new Date(); state.endAt = new Date(state.startedAt.getTime() + CONFIG.durationMinutes*60000);
    document.getElementById('authCard').style.display='none'; document.getElementById('app').style.display='block';
    renderNav(); renderQuestion(); startTimer(CONFIG.durationMinutes);
    if(loadLocal()){ if(confirm('Terdapat data tersimpan. Muat jawaban sebelumnya?')){ renderNav(); renderQuestion(); }}
  });

  // Controls
  el('nextBtn').addEventListener('click', next); el('prevBtn').addEventListener('click', prev);
  el('nextBtnBottom').addEventListener('click', next); el('prevBtnBottom').addEventListener('click', prev);
  el('submitBtn').addEventListener('click', submit); el('saveBtn').addEventListener('click', saveLocal);
  el('clearBtn').addEventListener('click', ()=>{ state.answers[state.cur]=null; renderNav(); renderQuestion(); });
  el('flagBtn').addEventListener('click', ()=>{ state.flagged[state.cur]=!state.flagged[state.cur]; alert(state.flagged[state.cur]? 'Soal ditandai.':'Tanda soal dihapus.'); });

  // Keyboard shortcuts
  window.addEventListener('keydown',(ev)=>{
    if(document.activeElement.tagName==='INPUT') return;
    if(ev.key==='ArrowRight') next(); if(ev.key==='ArrowLeft') prev();
    if(['1','2','3','4','5'].includes(ev.key)){
      const idx = Number(ev.key)-1; const q = questions[state.cur]; if(idx < q.choices.length) selectChoice(idx);
    }
  });

  // init
  renderNav();
  </script>
</body>
</html>
