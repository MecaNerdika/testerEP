<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Speed Math</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#2E2DA4;
  --danger:#d32f2f;
  --success:#2e7d32;
  --bg:#f4f6fb;
  --card:#ffffff;
}

*{box-sizing:border-box;font-family:'Segoe UI',sans-serif;}

body{
  background:var(--bg);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  margin:0;
}

.card{
  background:var(--card);
  padding:26px;
  width:100%;
  max-width:480px;
  border-radius:22px;
  box-shadow:0 12px 35px rgba(0,0,0,.12);
  text-align:center;
}

h1{color:var(--primary);margin-top:0;}

select,input{
  width:100%;
  padding:16px;
  font-size:18px;
  border-radius:14px;
  border:2px solid #ddd;
  text-align:center;
}

button{
  width:100%;
  padding:18px;
  font-size:20px;
  border:none;
  border-radius:16px;
  background:var(--primary);
  color:white;
  cursor:pointer;
}

.hidden{display:none;}

.time-set{
  display:flex;
  gap:10px;
  margin:20px 0;
}

.time-box{flex:1;}
.time-box span{
  display:block;
  margin-top:6px;
  font-size:14px;
  color:#555;
}

.timer{font-size:22px;font-weight:bold;}
.question{font-size:38px;margin:24px 0;}

.feedback{
  font-size:18px;
  margin-top:12px;
  min-height:24px;
}
.feedback.wrong{color:var(--danger);}
.feedback.right{color:var(--success);}

.keypad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  margin-top:20px;
}
.keypad button{
  font-size:24px;
  padding:22px;
}
.keypad .action{background:#444;}
</style>
</head>

<body>

<div class="card">

<h1>Speed Math</h1>
<p>Uji Kecepatan Perkalian & Pembagian</p>

<!-- START -->
<div id="startScreen">
  <select id="level">
    <option value="5">Mudah (1–5)</option>
    <option value="10" selected>Sedang (1–10)</option>
    <option value="15">Sulit (1–15)</option>
    <option value="20">Asia (11–20)</option>
  </select>

  <div class="time-set">
    <div class="time-box">
      <input type="number" id="h" value="0" min="0">
      <span>Jam</span>
    </div>
    <div class="time-box">
      <input type="number" id="m" value="1" min="0" max="59">
      <span>Menit</span>
    </div>
    <div class="time-box">
      <input type="number" id="s" value="0" min="0" max="59">
      <span>Detik</span>
    </div>
  </div>

  <button onclick="startTest()">Mulai</button>
</div>

<!-- TEST -->
<div id="testScreen" class="hidden">
  <div class="timer" id="time"></div>
  <div class="question" id="question"></div>

  <input type="number" id="answer" placeholder="Jawaban">
  <div class="feedback" id="feedback"></div>
  <div id="keypad" class="keypad hidden"></div>
</div>

<!-- RESULT -->
<div id="resultScreen" class="hidden">
  <h2>Hasil</h2>
  <p>Total Terjawab: <b id="total"></b></p>
  <p>Benar: <b id="correct"></b></p>
  <p>Salah: <b id="wrong"></b></p>
  <p>Kecepatan: <b id="speed"></b> soal/menit</p>
  <button onclick="location.reload()">Ulangi</button>
</div>

</div>

<script>
let maxNum,totalSeconds,startSeconds;
let total=0,correct=0,wrong=0;
let currentAnswer=0,timer;

const qEl=document.getElementById("question");
const ansEl=document.getElementById("answer");
const fb=document.getElementById("feedback");
const timeEl=document.getElementById("time");

function rand(min,max){
  return Math.floor(Math.random()*(max-min+1))+min;
}

function fmt(sec){
  let h=Math.floor(sec/3600),
      m=Math.floor(sec%3600/60),
      s=sec%60;
  return `${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;
}

function newQuestion(){
  let A=rand(1,maxNum),B=rand(1,maxNum),C=A*B;
  if(Math.random()<0.5){
    qEl.textContent=`${A} × ${B} = ?`;
    currentAnswer=C;
  }else{
    qEl.textContent=`${C} ÷ ${A} = ?`;
    currentAnswer=B;
  }
  ansEl.value="";
  fb.textContent="";
}

function startTest(){
  maxNum=parseInt(document.getElementById("level").value);

  let h=parseInt(document.getElementById("h").value)||0;
  let m=parseInt(document.getElementById("m").value)||0;
  let s=parseInt(document.getElementById("s").value)||0;

  totalSeconds=startSeconds=h*3600+m*60+s;
  if(totalSeconds<=0){
    alert("Waktu harus lebih dari 0 detik");
    return;
  }

  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("testScreen").classList.remove("hidden");

  timeEl.textContent=fmt(totalSeconds);
  newQuestion();
  ansEl.focus();

  if(/Mobi|Android/i.test(navigator.userAgent)) buildKeypad();

  timer=setInterval(()=>{
    totalSeconds--;
    timeEl.textContent=fmt(totalSeconds);
    if(totalSeconds<=0) finish();
  },1000);
}

function submit(){
  if(ansEl.value==="") return;

  total++;
  if(parseInt(ansEl.value)===currentAnswer){
    correct++;
    fb.textContent="✔ Benar";
    fb.className="feedback right";
    setTimeout(newQuestion,300);
  }else{
    wrong++;
    fb.textContent="✖ Jawaban salah, coba lagi";
    fb.className="feedback wrong";
    ansEl.value="";
  }
}

ansEl.addEventListener("keydown",e=>{
  if(e.key==="Enter") submit();
});

function buildKeypad(){
  const keypad=document.getElementById("keypad");
  keypad.classList.remove("hidden");
  ["1","2","3","4","5","6","7","8","9","0","⌫","✔"].forEach(k=>{
    let b=document.createElement("button");
    b.textContent=k;
    b.className=k==="✔"||k==="⌫"?"action":"";
    b.onclick=()=>{
      if(k==="⌫") ansEl.value=ansEl.value.slice(0,-1);
      else if(k==="✔") submit();
      else ansEl.value+=k;
    };
    keypad.appendChild(b);
  });
}

function finish(){
  clearInterval(timer);
  document.getElementById("testScreen").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  document.getElementById("total").textContent=total;
  document.getElementById("correct").textContent=correct;
  document.getElementById("wrong").textContent=wrong;
  document.getElementById("speed").textContent=
    (total/(startSeconds/60)).toFixed(2);
}
</script>

</body>
</html>

